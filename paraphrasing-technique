import os
import pandas as pd
from openai import OpenAI

# Load the dataset
file_path = '/content/new-dreaddit-train.csv'
df_filtered = pd.read_csv(file_path)

# Function to generate paraphrase using the new API
def paraphrase(text):
    response = client.chat.completions.create(
        model="gpt-4o-mini",  # Use the appropriate model
        messages=[
            {"role": "system", "content": "You are a helpful assistant."},
            {"role": "user", "content": f"Generate a paraphrase for the following text, keeping the sentiment the same: {text}"}
        ],
        max_tokens=150,  # Adjust based on your text length and model limits
        temperature=0.7
    )
    return response.choices[0].message.content.strip()  # Corrected line

# Generate paraphrased texts
paraphrased_data = []
for index, row in df_filtered.iterrows():
    paraphrased_text = paraphrase(row['text'])
    paraphrased_data.append({
        'text': row['text'],
        'paraphrased_text': paraphrased_text,
        'sentiment': row['sentiment'],
        'confidence': row['confidence'],
        'subreddit': row['subreddit'],
        'label': row['label']
    })

# Save to a CSV file
paraphrased_df = pd.DataFrame(paraphrased_data)
output_file_path = '/content/paraphrased-dreaddit-train.csv'
paraphrased_df.to_csv(output_file_path, index=False)

print("Paraphrased records saved to 'paraphrased-dreaddit-train.csv'")
